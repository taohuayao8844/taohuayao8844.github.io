# FM（频率调制）全方位知识体系：从数学原理到工程实践

## 1. FM调制原理与数学模型

### 1.1 FM调制的核心物理逻辑

#### 1.1.1 载波基础与调制规律

频率调制（Frequency Modulation, FM）是一种模拟调制技术，其核心在于利用基带信号（或称调制信号）的幅度变化来控制高频载波的瞬时频率。在FM系统中，信息并非通过改变载波的幅度来承载，而是通过精确调控其频率的瞬时偏移来实现。一个未调制的载波可以表示为一个具有固定频率 $f_c$（或角频率 $\omega_c = 2\pi f_c$）和固定幅度 $A$ 的正弦波。当引入基带信号 $m(t)$ 后，FM信号的瞬时角频率 $\omega(t)$ 不再是常数，而是与 $m(t)$ 成线性关系。具体来说，瞬时角频率的表达式为 $\omega(t) = \omega_c + k_f \cdot m(t)$，其中 $k_f$ 是一个关键参数，称为**频率灵敏度**或调频灵敏度，其单位通常是 rad/(s·V)。这个参数定义了基带信号每单位电压变化所能引起的载波角频率的偏移量，是衡量调制器效率的核心指标。当基带信号 $m(t)$ 的幅度为正时，瞬时频率会高于中心频率 $f_c$；反之，当 $m(t)$ 为负时，瞬时频率则低于 $f_c$；而当 $m(t)$ 为零时，载波频率恰好维持在中心频率 $f_c$ 上。这种调制方式确保了信息的完整映射，基带信号的每一个细微变化都能引起载波频率的相应波动，从而为后续的解调过程提供了丰富的信息基础。

#### 1.1.2 与AM调制的本质区别

FM调制与幅度调制（Amplitude Modulation, AM）在信息承载方式上存在本质区别，这直接导致了两者在性能和应用场景上的巨大差异。AM调制的核心思想是让载波的幅度随基带信号的幅度变化而变化，而载波的频率和相位保持不变。这意味着在AM信号中，所有信息都包含在包络线的起伏之中。然而，这种调制方式有一个显著的弱点：**它对信道中的幅度噪声和干扰非常敏感**。任何叠加在信号上的噪声都会直接改变信号的幅度，从而在解调后形成噪声，严重影响通信质量。相比之下，FM调制的核心特征是**恒包络**，即FM信号的载波幅度 $A$ 始终保持恒定，不随基带信号的变化而改变 。信息被编码在频率的变化中，而非幅度。这一特性赋予了FM系统极强的抗干扰能力。在信号传输过程中，绝大多数噪声（如大气噪声、电路热噪声）主要表现为对信号幅度的干扰。在FM接收机中，可以通过一个称为“限幅器”的电路来切除这些幅度上的波动，从而几乎完全消除幅度噪声的影响，而不会影响信号中携带的频率信息。因此，FM广播、电视伴音以及高质量无线通信系统普遍采用FM调制，以获得比AM更高的信噪比和更清晰的音质。

#### 1.1.3 抗干扰能力分析

FM系统的卓越抗干扰能力主要源于其恒包络特性和解调过程中的“门限效应”。首先，如前所述，FM信号的幅度恒定，使得接收机前端可以配置限幅器，有效滤除由信道引入的寄生调幅噪声 。这是FM相对于AM最直观的优势。其次，FM解调过程本身具有一个被称为 **“FM改善因子”** 或“FM增益”的特性。在理想的FM解调器中，输出信噪比（SNR）与输入信噪比的关系并非线性。当输入信噪比高于某个特定值（称为 **“门限”** ）时，FM解调器的输出信噪比会随着调制指数 $\beta_f$ 的增加而显著提高。这是因为解调器将频率的微小变化转换成了较大的电压变化，相当于对信号进行了放大，而对噪声则没有这种放大效应。然而，当输入信噪比低于门限值时，情况会急剧恶化，输出信噪比会迅速下降，这种现象被称为 **“门限效应”** 。尽管如此，在正常的通信条件下，通过合理设计调制指数和系统带宽，FM系统可以在远高于门限的信噪比下工作，从而获得巨大的抗噪声优势。例如，在FM广播中，典型的调制指数 $\beta_f$ 约为5，这意味着其抗噪声性能远优于AM广播。

### 1.2 FM信号的数学表达式推导

#### 1.2.1 瞬时角频率的数学定义

FM信号的数学建模始于其瞬时角频率的定义。对于一个标准的正弦载波，其瞬时角频率 $\omega(t)$ 是一个常数 $\omega_c$。在频率调制中，这个角频率被基带信号 $m(t)$ 所调制。根据FM调制的核心物理逻辑，瞬时角频率与基带信号的幅度成正比。因此，我们可以写出瞬时角频率的通用表达式：

$$ \omega(t) = \omega_c + k_f \cdot m(t) $$

这个公式是FM调制的基石。其中，$\omega_c = 2\pi f_c$ 是载波的中心角频率，代表了未调制时的频率。$k_f$ 是频率灵敏度，它决定了调制的深度和效率，其物理意义是单位调制电压引起的角频率偏移量 。$m(t)$ 是随时间变化的基带信号，例如音频信号。这个公式清晰地表明，FM信号的瞬时频率在中心频率 $f_c$ 的基础上，围绕其上下波动，波动的幅度和方向完全由基带信号 $m(t)$ 的瞬时值决定。例如，如果 $m(t)$ 是一个正弦波，那么瞬时频率也将呈现正弦波形式的周期性变化。这个数学关系为后续推导FM信号的完整时域表达式提供了最直接的出发点。

#### 1.2.2 瞬时相位的积分推导

在定义了瞬时角频率之后，下一步是推导出FM信号的瞬时相位 $\phi(t)$。根据信号与系统的基本理论，瞬时角频率是瞬时相位对时间的导数，即 $\omega(t) = \frac{d\phi(t)}{dt}$。因此，要得到瞬时相位，我们需要对瞬时角频率进行积分。将上一步得到的瞬时角频率表达式代入，可得：

$$ \phi(t) = \int \omega(t) dt = \int [\omega_c + k_f \cdot m(t)] dt $$

对这个积分进行分解，可以得到：

$$ \phi(t) = \omega_c t + k_f \int_{0}^{t} m(\tau) d\tau $$

这里，积分下限通常取为0，表示从某个初始时刻开始计算相位。这个结果是FM信号数学表达式的关键部分。它表明，FM信号的瞬时相位由两部分组成：一部分是线性增长的载波相位 $\omega_c t$，另一部分是基带信号 $m(t)$ 的积分项。这个积分项引入了相位的非线性变化，是承载信息的核心。基带信号 $m(t)$ 的积分意味着相位变化不仅与 $m(t)$ 的当前值有关，还与其历史值有关，这体现了FM调制的记忆特性。这个相位表达式将直接用于构建FM信号的完整时域波形。

#### 1.2.3 FM调制信号的完整时域表达式

有了瞬时相位的表达式，我们就可以构建出FM信号在时域中的完整数学表达式。一个正弦波信号的一般形式是 $s(t) = A \cos[\phi(t)]$，其中 $A$ 是恒定的幅度，$\phi(t)$ 是瞬时相位。将上一步推导出的瞬时相位代入，我们得到FM信号的通用表达式：

$$ s_{\text{FM}}(t) = A \cdot \cos\left[ \omega_c t + k_f \int_{0}^{t} m(\tau) d\tau \right] $$

这个公式精确地描述了FM信号在任意时刻 $t$ 的波形。它清晰地展示了FM信号的三个核心特征：恒定的幅度 $A$、作为载波的线性相位项 $\omega_c t$，以及包含调制信息的积分项 $k_f \int m(\tau) d\tau$。为了更具体地理解，我们可以考虑一个常见的测试场景，即基带信号为单频正弦波的情况。设 $m(t) = V_m \cos(\omega_m t)$，其中 $V_m$ 是基带信号的幅度，$\omega_m = 2\pi f_m$ 是其角频率。将其代入通用表达式，积分项变为：

$$ k_f \int_{0}^{t} V_m \cos(\omega_m \tau) d\tau = \frac{k_f V_m}{\omega_m} \sin(\omega_m t) $$

因此，对于单频基带信号，FM信号的表达式可以简化为：

$$ s_{\text{FM}}(t) = A \cdot \cos\left[ \omega_c t + \beta_f \sin(\omega_m t) \right] $$

其中，$\beta_f = \frac{k_f V_m}{\omega_m}$ 被定义为FM调制系数，它将在下一节中详细讨论。这个简化形式在工程分析和仿真中非常有用，因为它将复杂的积分运算转化为了一个更易于处理的正弦函数。

### 1.3 FM调制系数（βf）的深入解析

#### 1.3.1 最大频偏（Δf_max）的定义与计算

最大频偏（$\Delta f_{\text{max}}$）是FM调制中的一个关键参数，它定义了载波频率偏离其中心频率 $f_c$ 的最大范围。这个参数直接反映了调制的深度，即基带信号对载波频率控制的剧烈程度。根据FM瞬时角频率的定义 $\omega(t) = \omega_c + k_f \cdot m(t)$，瞬时频率 $f(t)$ 可以表示为 $f(t) = f_c + \frac{k_f}{2\pi} m(t)$。因此，频率的偏移量 $\Delta f(t)$ 为 $\frac{k_f}{2\pi} m(t)$。最大频偏 $\Delta f_{\text{max}}$ 就是当基带信号 $m(t)$ 达到其最大幅度 $|m(t)|_{\text{max}}$ 时所对应的频率偏移。其计算公式为：

$$ \Delta f_{\text{max}} = \frac{k_f \cdot |m(t)|_{\text{max}}}{2\pi} $$

这个公式清晰地表明，最大频偏与频率灵敏度 $k_f$ 和基带信号的最大幅度成正比。例如，在FM广播标准中，最大频偏通常被规定为**75kHz**，这意味着载波频率可以在中心频率的基础上上下浮动最多75kHz。这个参数不仅决定了FM信号的带宽，也直接影响了解调后信号的质量。一个较大的最大频偏通常意味着更高的信噪比，因为频率的微小变化更容易被解调器分辨出来，但同时也意味着需要更宽的频谱资源。因此，在系统设计时，需要根据应用需求（如音质要求、信道带宽限制）来权衡选择 $\Delta f_{\text{max}}$ 的值。

#### 1.3.2 调制系数（βf）的物理意义与公式

FM调制系数，也称为**频偏比**（$\beta_f$），是一个无量纲的参数，它更深刻地揭示了FM调制的本质。调制系数定义为最大频偏 $\Delta f_{\text{max}}$ 与基带信号最高频率 $f_m$ 的比值：

$$ \beta_f = \frac{\Delta f_{\text{max}}}{f_m} $$

这个比值综合了调制深度（由 $\Delta f_{\text{max}}$ 体现）和基带信号的特性（由 $f_m$ 体现）。将最大频偏的公式代入，可以得到调制系数的另一种表达形式，特别是在单频基带信号 $m(t) = V_m \cos(\omega_m t)$ 的情况下：

$$ \beta_f = \frac{k_f V_m}{2\pi f_m} = \frac{k_f V_m}{\omega_m} $$

这个公式表明，调制系数不仅与调制器的灵敏度 $k_f$ 和基带信号的幅度 $V_m$ 有关，还与基带信号的频率 $f_m$ 成反比。这意味着，对于同一个调制器和同一个基带信号幅度，频率越高的基带信号分量，其对应的调制系数越小。调制系数是判断FM信号频谱特性的核心依据。它直接决定了FM信号中边频分量的数量和幅度，进而决定了信号的有效带宽。在工程实践中，$\beta_f$ 是一个比 $\Delta f_{\text{max}}$ 更具指导意义的参数，因为它将调制深度与信号带宽直接关联起来，为系统设计和性能分析提供了便利。

#### 1.3.3 窄带FM（NBFM）与宽带FM（WBFM）的划分与应用

根据调制系数 $\beta_f$ 的大小，FM调制可以分为两大类：**窄带FM（Narrowband FM, NBFM）** 和**宽带FM（Wideband FM, WBFM）** 。这个划分对于理解FM信号的频谱特性和应用场景至关重要。

- **窄带FM (NBFM)** ：当调制系数 $\beta_f$ 远小于1时（通常定义为 $\beta_f < 0.5$），我们称之为窄带FM。在这种情况下，FM信号的频谱结构与AM信号非常相似，主要由载波频率和一对上下边带组成，其带宽近似为 $2f_m$。NBFM的主要优点是占用带宽窄，频谱效率高，因此常用于对带宽要求苛刻的通信系统，如双向无线电对讲机、警用通信、以及一些低速率的数据传输系统。在这些应用中，虽然音质和抗噪性不如WBFM，但其高效的频谱利用率是关键。

- **宽带FM (WBFM)** ：当调制系数 $\beta_f$ 远大于1时（通常定义为 $\beta_f > 1$，在广播中常为5到10），我们称之为宽带FM。WBFM信号的频谱非常宽，包含大量的边频分量，其带宽远大于基带信号的最高频率。根据卡森带宽规则，WBFM的带宽近似为 $2(\Delta f_{\text{max}} + f_m)$。WBFM的主要优点是抗噪声和干扰能力极强，能够提供非常高的保真度。这是因为大的频偏使得信号能量分散在更宽的频带上，从而降低了单位带宽内的噪声功率。因此，WBFM被广泛应用于高保真音频广播（如FM广播电台，其标准频偏为75kHz）、电视伴音、以及高质量的音乐传输等场景。

| 特性                     | 窄带FM (NBFM)                    | 宽带FM (WBFM)                                      |
| :----------------------- | :------------------------------- | :------------------------------------------------- |
| **调制系数 ($\beta_f$)** | $\beta_f \ll 1$ (通常 < 0.5)     | $\beta_f \gg 1$ (通常 > 1)                         |
| **频谱结构**             | 类似AM，主要由载波和一对边带组成 | 包含大量边频分量，频谱结构复杂                     |
| **带宽**                 | 近似为 $2f_m$                    | 近似为 $2(\Delta f_{\text{max}} + f_m)$ (卡森规则) |
| **抗噪性能**             | 较差                             | 极佳                                               |
| **音质**                 | 一般                             | 高保真                                             |
| **应用场景**             | 双向无线电、警用通信、低速数据   | FM广播、电视伴音、高质量音频传输                   |

#### 1.3.4 调制系数计算实例

为了更好地理解调制系数的计算和应用，我们来看一个具体的例子。假设我们有一个基带信号 $m(t) = 2\cos(2\pi \times 3000t)$，其幅度 $V_m = 2V$，频率 $f_m = 3kHz$。我们使用的调制器频率灵敏度为 $k_f = 2\pi \times 10^5$ rad/(s·V)。

首先，我们计算最大频偏 $\Delta f_{\text{max}}$：
$$ \Delta f_{\text{max}} = \frac{k_f \cdot |m(t)|_{\text{max}}}{2\pi} = \frac{(2\pi \times 10^5) \times 2}{2\pi} = 2 \times 10^5 \text{ Hz} = 200 \text{ kHz} $$

这个结果表明，载波频率将在中心频率的基础上，根据基带信号的幅度，在 $\pm 200kHz$ 的范围内变化。

接下来，我们计算调制系数 $\beta_f$：
$$ \beta_f = \frac{\Delta f_{\text{max}}}{f_m} = \frac{200 \text{ kHz}}{3 \text{ kHz}} \approx 66.7 $$

计算得到的调制系数 $\beta_f \approx 66.7$ 远大于1，因此这是一个典型的**宽带FM（WBFM）** 信号。如此大的调制指数意味着该FM信号具有非常强的抗噪声能力，但同时也会占用非常宽的频谱。根据卡森带宽规则，其近似带宽为 $B \approx 2(\Delta f_{\text{max}} + f_m) = 2(200kHz + 3kHz) = 406kHz$。这个例子清晰地展示了调制系数如何量化调制深度，并帮助我们判断信号的频谱特性和适用场景。

## 2. FM解调技术：原理、性能与实现

### 2.1 鉴频法：从频率到幅度的转换

鉴频法是FM解调技术中最基础且直观的一类方法，其核心思想在于将频率的变化信息转换为幅度的变化信息，从而可以利用成熟的AM信号解调技术（如包络检波）来恢复原始的基带信号。这类方法通常被称为非相干解调，因为它不依赖于与载波同步的本地参考信号。其基本流程可以概括为：首先，通过一个特定的电路（如微分器或谐振回路）处理FM信号，使其幅度能够反映瞬时频率的变化，生成一个调幅-调频（AM-FM）波；然后，利用包络检波器提取出这个AM-FM波的包络，该包络即为与原始调制信号成正比的输出。这种方法的优点是电路结构相对简单，成本较低，但其性能，特别是线性度和抗干扰能力，在很大程度上取决于频率-幅度转换电路的特性。

#### 2.1.1 核心原理：利用谐振回路的幅频特性

鉴频法最经典的实现方式是利用线性谐振回路（如LC并联或串联回路）的幅频特性曲线。一个理想的谐振回路在其谐振频率点 `f0` 处输出幅度最大，当输入信号频率偏离 `f0` 时，输出幅度会随之下降，形成一个以 `f0` 为中心的对称曲线。为了实现线性鉴频，FM信号的中心频率 `fc` 并不设置在谐振回路的谐振频率 `f0` 上，而是故意将其设置在幅频特性曲线的某一侧斜坡上。这样，当FM信号的瞬时频率随着基带信号 `m(t)` 的变化而在 `fc` 附近波动时，其对应的输出幅度也会沿着这个斜坡线性变化。例如，当瞬时频率升高时，输出幅度会相应增大（或减小，取决于工作在哪一侧斜坡）；反之，当瞬时频率降低时，输出幅度则会减小（或增大）。通过这种方式，频率的变化就被线性地转换成了幅度的变化。这种利用幅频特性曲线斜率进行鉴频的方法被称为 **“斜率鉴频法”** 。其关键在于找到一个足够线性的工作区域，以保证解调输出的失真最小。然而，实际的谐振回路幅频特性曲线在远离 `f0` 的区域会呈现出明显的非线性，这限制了斜率鉴频法的线性工作范围和动态范围。

#### 2.1.2 数学推导：微分器将FM波转换为AM-FM波

从数学角度看，鉴频法可以通过对FM信号进行微分来实现。标准的FM信号表达式为：
$$ s_{\text{FM}}(t) = A \cos\left[ \omega_c t + k_f \int_{0}^{t} m(\tau) d\tau \right] $$
对该信号求时间导数，得到：
$$ \frac{ds_{\text{FM}}(t)}{dt} = -A \left[ \omega_c + k_f m(t) \right] \sin\left[ \omega_c t + k_f \int_{0}^{t} m(\tau) d\tau \right] $$
这个表达式可以被重新写成一个标准的AM信号形式。令 `θ(t) = ωc t + kf ∫m(τ)dτ`，则上式变为：
$$ \frac{ds_{\text{FM}}(t)}{dt} = A \left[ \omega_c + k_f m(t) \right] \sin\left[ \theta(t) - \frac{\pi}{2} \right] $$
在这里，信号的包络（幅度）是 `A[ωc + kf m(t)]`，它直接与基带信号 `m(t)` 成线性关系。而信号的相位部分 `sin[θ(t) - π/2]` 仍然保留了FM的特性。因此，经过微分器后，原始的FM波被转换成了一个幅度和频率都随 `m(t)` 变化的调幅-调频（AM-FM）波。接下来的任务就是从这样一个复合调制信号中提取出幅度信息。这可以通过一个包络检波器来完成，它通常由一个二极管和一个RC低通滤波器组成。二极管负责整流（半波或全波），将信号的负半周翻转到正半周，形成一个脉动的直流信号。然后，RC低通滤波器滤除高频的载波分量，保留低频的包络变化，最终得到与 `m(t)` 成正比的输出电压。这个过程的数学本质就是取信号的绝对值（或半波整流）后进行低通滤波，从而恢复出原始的调制信号 。

#### 2.1.3 性能分析：线性度、带宽与抗干扰能力

鉴频法的性能主要取决于其频率-幅度转换的线性度。在斜率鉴频法中，线性度完全依赖于谐振回路幅频特性曲线的线性区域。这个区域通常比较窄，因此其线性工作带宽有限，不适合处理具有较大频偏的宽带FM信号。当输入信号的频率偏移超出线性区时，解调输出会产生严重的非线性失真。此外，任何叠加在FM信号上的幅度噪声（如信道中的加性噪声）都会直接通过包络检波器反映在输出端，因此斜率鉴频法的抗干扰能力相对较弱。虽然可以在鉴频前加入限幅器来消除幅度噪声，但这会增加电路的复杂性。相比之下，基于微分器的鉴频法在理论上具有更好的线性度，因为微分操作本身是线性的。然而，实际电路中的微分器（如RC高通网络）其幅频特性也并非完全线性，同样会引入一定的失真。鉴频法的另一个关键性能指标是其鉴频灵敏度，即单位频率变化引起的输出电压变化量，这直接决定了解调输出的信噪比。总的来说，鉴频法因其结构简单、易于实现，在对性能要求不高的场合（如消费级收音机）仍有应用，但在高性能通信系统中，其线性度和抗干扰能力的局限性使其逐渐被更先进的解调方法（如锁相环解调）所取代。

#### 2.1.4 电路实现：斜率鉴频与比例鉴频

斜率鉴频器的电路实现非常直接，通常由一个LC谐振回路和一个二极管包络检波器构成。FM信号被送入LC回路，该回路的谐振频率被调谐到偏离FM中心频率 `fc` 的一个固定值，使得 `fc` 恰好位于其幅频特性曲线的线性斜坡上。回路的输出信号已经是一个AM-FM波，然后直接送入包络检波器进行解调。这种方法的优点是电路极其简单，但缺点是线性度差，且对输入信号的幅度变化敏感。

为了改善线性度和抗干扰能力，工程师们设计了更复杂的鉴频电路，其中一种重要的改进是**比例鉴频器**。比例鉴频器通常采用一个双调谐耦合回路（如变压器耦合的初级和次级LC回路），两个回路都调谐在FM信号的中心频率 `fc` 上。FM信号同时加到两个回路上，并在次级回路中产生两个相位相反、幅度相等的电压。这两个电压与初级回路的电压进行矢量叠加，形成两个新的电压信号，分别送入两个对称的二极管包络检波器。由于两个检波器的输出是差分连接的，其最终输出电压与两个输入电压的幅度之比有关，因此得名“比例鉴频器”。这种结构的一个重要特性是，当输入FM信号的幅度发生波动（即存在寄生调幅）时，两个检波器的输入电压会同向变化，其比值保持不变，从而使得输出电压不受幅度变化的影响。这赋予了比例鉴频器很强的抗寄生调幅能力，显著优于简单的斜率鉴频器。其鉴频特性曲线通常呈“S”形，在中心频率 `fc` 附近具有良好的线性度，是FM广播接收机中广泛采用的鉴频电路 。

### 2.2 相位鉴频法：频率-相位-幅度的转换

相位鉴频法是另一类重要的FM解调技术，它通过将频率的变化转换为相位的变化，再将相位的变化转换为幅度的变化，最终实现解调。与鉴频法直接利用幅频特性不同，相位鉴频法利用了相频特性。其核心思想是：设计一个网络，使得输入信号的相位对其频率的变化非常敏感，然后将这个相位变化信息转换成幅度变化，以便通过包络检波等方式提取出来。这种方法通常能提供比简单斜率鉴频法更好的线性度和灵敏度，因此在许多高性能FM接收机中得到了广泛应用。

#### 2.2.1 核心原理：基于耦合回路的相位偏移

相位鉴频法的核心在于一个能够产生频率相关相位偏移的网络。最常见的实现方式是使用一个耦合谐振回路，例如一个变压器，其初级和次级线圈之间存在互感。FM信号被送入初级回路，同时在次级回路中感应出电压。由于互感的存在，次级回路中的电流和电压相对于初级回路的电压会产生一个相位差。这个相位差的大小与输入信号的频率密切相关。当输入信号频率等于回路的谐振频率时，次级电压与初级电压同相或反相（取决于耦合方式）；当频率偏离谐振频率时，相位差会随之线性变化。通过精心设计耦合回路的参数，可以使得在FM信号的工作频带内，相位差与频率偏移之间保持良好的线性关系。这样，频率的变化就被成功地转换成了相位的变化。接下来的任务就是将这个相位信息“解码”成幅度信息。这通常通过将原始FM信号（作为参考）与经过相移网络后的信号进行矢量叠加来实现。叠加后的合成信号，其幅度将取决于两个信号之间的相位差，从而实现了从频率到相位的转换。

#### 2.2.2 数学推导：相位差与输出电压的关系

为了更精确地理解相位鉴频法，我们可以进行数学推导。假设输入的FM信号为 `V_in(t) = A cos(ωt + φ(t))`，其中 `φ(t)` 是由基带信号 `m(t)` 引起的相位变化。这个信号被分为两路：一路直接作为参考信号 `V_ref(t)`，另一路经过一个相移网络，产生一个与频率相关的相移 `θ(ω)`，得到信号 `V_shift(t) = B cos(ωt + φ(t) + θ(ω))`。这两个信号在叠加器中相加，得到合成信号 `V_sum(t)`：
$$ V_{\text{sum}}(t) = V_{\text{ref}}(t) + V_{\text{shift}}(t) = A \cos(\omega t + \phi(t)) + B \cos(\omega t + \phi(t) + \theta(\omega)) $$
利用三角恒等式，可以将上式化简为：
$$ V_{\text{sum}}(t) = R \cos(\omega t + \phi(t) + \alpha) $$
其中，合成信号的幅度 `R` 为：
$$ R = \sqrt{A^2 + B^2 + 2AB \cos(\theta(\omega))} $$
可以看到，合成信号的幅度 `R` 直接取决于两个信号之间的相位差 `θ(ω)`。由于 `θ(ω)` 是频率 `ω` 的函数，因此 `R` 也随频率变化。通过设计相移网络，使得 `θ(ω)` 在FM信号的工作频带内与频率偏移 `Δω = ω - ωc` 成线性关系，即 `θ(ω) ≈ k * Δω`，那么 `R` 就会与 `Δω` 建立起一个确定的函数关系。在 `θ(ω)` 较小的情况下，`cos(θ(ω)) ≈ 1 - (θ(ω))^2 / 2`，此时 `R` 与 `Δω` 的平方成正比，呈现出非线性关系。为了获得线性输出，通常会采用更复杂的电路结构，如乘积型鉴频器，它通过乘法器和低通滤波器来直接处理两个信号的相位关系，从而得到与 `sin(θ(ω))` 或 `θ(ω)` 成正比的输出，在小角度近似下实现线性解调。

#### 2.2.3 性能分析：线性度与灵敏度优势

相位鉴频法相比于斜率鉴频法，其最大的优势在于更好的线性度和更高的灵敏度。线性度的改善主要源于相频特性曲线在谐振频率附近通常比幅频特性曲线具有更宽的线性区域。这意味着相位鉴频器可以处理具有更大频偏的FM信号，同时保持较低的解调失真。灵敏度方面，由于相位变化对频率变化的响应非常敏锐，即使是微小的频率偏移也能引起显著的相位差变化，从而产生较大的输出电压变化，因此相位鉴频器通常具有更高的鉴频灵敏度。此外，许多相位鉴频器电路（如比例鉴频器）本身就具有抑制寄生调幅的能力，因为它们的输出取决于两个信号电压的比值或差值，当输入信号幅度同向变化时，其影响可以被抵消。然而，相位鉴频器的电路结构通常比斜率鉴频器复杂，需要精确的元件匹配和调试，特别是相移网络的设计对性能影响巨大。其性能同样受到元件参数漂移、温度变化等因素的影响，需要在设计中进行充分考虑。

#### 2.2.4 电路实现：乘积型相位鉴频器

乘积型相位鉴频器是一种常见的相位鉴频电路实现方式。其基本结构包括一个相移网络、一个乘法器（或混频器）和一个低通滤波器。FM信号 `s_FM(t)` 被送入相移网络（通常是一个LC谐振回路或RC网络），产生一个与频率相关的相移，得到信号 `s'_FM(t)`。同时，原始的 `s_FM(t)` 作为参考信号。这两个信号被送入乘法器进行相乘。根据三角函数的积化和差公式，乘法器的输出 `V_mult(t)` 为：
$$ V_{\text{mult}}(t) = s_{\text{FM}}(t) \cdot s'_{\text{FM}}(t) = A \cos(\omega_c t + \phi(t)) \cdot B \cos(\omega_c t + \phi(t) + \theta(\omega)) $$
$$ = \frac{AB}{2} \left[ \cos(\theta(\omega)) + \cos(2\omega_c t + 2\phi(t) + \theta(\omega)) \right] $$
这个输出包含两个部分：一个低频分量 `(AB/2)cos(θ(ω))`，其大小与相位差 `θ(ω)` 有关；一个高频分量，其频率是载波频率的两倍。通过一个截止频率远低于 `2ωc` 的低通滤波器，可以将高频分量滤除，只保留低频分量。因此，低通滤波器的输出 `V_out(t)` 为：
$$ V_{\text{out}}(t) = \frac{AB}{2} \cos(\theta(\omega)) $$
通过设计相移网络，使得在FM信号的工作频带内，`θ(ω)` 与频率偏移 `Δω` 成线性关系，并且工作在一个较小的角度范围内（例如 `|θ(ω)| < π/6`），此时 `cos(θ(ω)) ≈ 1 - (θ(ω))^2 / 2`，输出仍然是非线性的。为了获得线性输出，更常见的做法是设计相移网络，使得 `θ(ω)` 在中心频率 `fc` 附近为 `π/2`，并且其变化量 `Δθ` 与 `Δω` 成正比。此时，`cos(π/2 + Δθ) = -sin(Δθ) ≈ -Δθ`，从而实现了输出电压与频率偏移的线性关系。这种鉴频方式因其良好的线性和灵敏度，在集成电路中得到了广泛应用 。

### 2.3 锁相环（PLL）解调法：现代主流技术

锁相环（Phase-Locked Loop, PLL）解调法是现代FM接收机中最常用、性能最优越的解调技术之一。与鉴频法和相位鉴频法通过硬件网络将频率信息转换为幅度或相位信息不同，PLL解调法利用一个闭环反馈控制系统，主动地“锁定”并“跟踪”输入FM信号的瞬时频率变化。其核心思想是：用一个压控振荡器（VCO）产生一个本地信号，通过比较本地信号与输入FM信号的相位差，生成一个误差电压。这个误差电压经过滤波后，反过来控制VCO的频率，使其尽可能与输入信号的频率保持一致。当环路稳定锁定后，VCO的控制电压就精确地反映了输入FM信号的瞬时频率偏移，从而实现了对基带信号的解调。

#### 2.3.1 核心原理：频率跟踪与VCO控制

PLL解调的核心在于其卓越的频率跟踪能力。一个基本的PLL由三个主要部分组成：鉴相器（Phase Detector, PD）、环路滤波器（Loop Filter, LF）和压控振荡器（Voltage-Controlled Oscillator, VCO）。其工作流程如下：
1.  **鉴相（Phase Detection）** ：输入的FM信号 `s_FM(t)` 和VCO产生的本地信号 `s_VCO(t)` 同时送入鉴相器。鉴相器的作用是检测这两个信号之间的瞬时相位差，并输出一个与该相位差成正比的电压信号 `V_d(t)`。
2.  **环路滤波（Loop Filtering）** ：鉴相器输出的电压 `V_d(t)` 通常包含高频噪声和载波的二次谐波分量。环路滤波器（通常是一个低通滤波器）的作用是滤除这些不需要的高频分量，平滑控制电压，并决定环路的动态特性（如带宽、阻尼等）。滤波后的电压 `V_c(t)` 被用作VCO的控制信号。
3.  **压控振荡（Voltage-Controlled Oscillation）** ：VCO是一个振荡频率受输入控制电压 `V_c(t)` 控制的振荡器。其输出频率 `f_VCO` 与控制电压 `V_c` 之间通常存在线性关系：`f_VCO = f_0 + K_o * V_c`，其中 `f_0` 是VCO的自由振荡频率，`K_o` 是VCO的增益系数（单位：rad/(s·V)）。
4.  **闭环反馈（Closed-Loop Feedback）** ：VCO的输出 `s_VCO(t)` 被反馈回鉴相器，形成一个负反馈闭环。当环路锁定时，VCO的频率会精确地跟踪输入FM信号的瞬时频率。由于 `f_FM_inst = f_c + k_f * m(t)`，而 `f_VCO` 跟踪 `f_FM_inst`，因此控制VCO频率的电压 `V_c(t)` 必然与 `k_f * m(t)` 成正比。这样，我们就从 `V_c(t)` 中恢复出了原始的基带信号 `m(t)` 。

#### 2.3.2 数学模型：PLL的线性化模型与传递函数

为了深入分析PLL的性能，需要建立其数学模型。在环路锁定且相位误差较小的情况下，可以将PLL的各个模块进行线性化处理。
-   **鉴相器**：其输出 `V_d` 与相位差 `Δφ` 的关系可以近似为线性：`V_d = K_d * Δφ`，其中 `K_d` 是鉴相器的增益（单位：V/rad）。
-   **环路滤波器**：其传递函数用 `F(s)` 表示，决定了环路的频率响应和稳定性。
-   **压控振荡器**：VCO本质上是一个积分器，因为它将输入的电压（对应频率）积分得到输出相位。其传递函数为 `K_o / s`，其中 `K_o` 是VCO增益（单位：rad/(s·V)）。

将这些线性化模型组合起来，可以得到整个PLL的闭环传递函数 `H(s)`，它描述了输入相位 `φ_i(s)` 与输出相位 `φ_o(s)` 之间的关系：
$$ H(s) = \frac{\phi_o(s)}{\phi_i(s)} = \frac{K_d K_o F(s)}{s + K_d K_o F(s)} $$
对于FM解调，我们更关心的是输入频率（即输入相位的导数）与输出控制电压 `V_c(s)` 之间的关系。由于输入频率 `ω_i(s) = s * φ_i(s)`，而VCO控制电压 `V_c(s)` 与VCO输出相位 `φ_o(s)` 的关系为 `φ_o(s) = (K_o / s) * V_c(s)`，可以推导出解调输出的传递函数。当输入为FM信号时，`ω_i(s)` 包含了基带信号 `M(s)` 的信息。通过分析这个传递函数，可以评估PLL解调器的性能，如其带宽、对不同频率调制信号的响应（幅频特性）、相位延迟（相频特性）以及稳定性。例如，一个设计良好的二阶PLL，其环路滤波器 `F(s)` 通常包含一个零点和一个极点，可以使得闭环系统具有足够的相位裕度，保证稳定工作，并且其带宽可以被精确控制，以在噪声抑制和信号跟踪能力之间取得最佳平衡 。

#### 2.3.3 性能分析：高精度、强抗干扰与可调带宽

PLL解调法之所以成为现代主流技术，是因为它在多个关键性能指标上都表现出色。
-   **高精度与线性度**：由于PLL是一个闭环反馈系统，其跟踪精度非常高。只要VCO的电压-频率特性是线性的，解调输出就能高度线性地复现原始基带信号，失真极小。其线性范围远比简单的鉴频器宽。
-   **强抗干扰能力**：PLL本质上是一个窄带跟踪滤波器。环路滤波器的带宽可以被设计得非常窄，只允许输入信号频率附近的频率分量通过，而将带外的噪声和干扰有效滤除。这种窄带特性使得PLL解调器具有极强的抗噪声和抗干扰能力，尤其是在信噪比较低的环境下，其性能远优于其他解调方法。
-   **可调带宽**：通过改变环路滤波器的参数（如电阻、电容值），可以方便地调整PLL的环路带宽。这使得设计者可以根据不同的应用场景进行优化。例如，在需要解调高频、大带宽的基带信号时，可以增大环路带宽以提高跟踪速度；而在噪声环境恶劣时，可以减小环路带宽以提高信噪比。
-   **集成化与灵活性**：现代PLL功能通常被集成在单个芯片中，如NE564，大大简化了电路设计和调试。同时，通过数字控制，可以实现对环路参数的灵活配置，适应多种通信标准。

#### 2.3.4 电路实现：基于NE564的FM解调器设计

NE564是一款经典的单片集成锁相环，专为高速信号处理（如FM解调、频率合成等）而设计。使用NE564实现FM解调器非常简便。其基本应用电路包括：
1.  **信号输入**：FM信号通过耦合电容输入到NE564的相位比较器输入端。
2.  **VCO设置**：VCO的自由振荡频率 `f_0` 需要通过外部电阻和电容来设定，使其接近输入FM信号的中心频率 `fc`。NE564的VCO频率范围很宽，可达数MHz。
3.  **环路滤波器**：NE564内部集成了一个鉴相器和一个跨导放大器，其输出端（引脚4和5）需要外接环路滤波器。通常，这是一个简单的RC网络，由一个电阻 `R` 和一个电容 `C` 组成。这个RC网络决定了环路的带宽和阻尼特性。根据NE564的数据手册，其内部已经集成了一个1.3kΩ的电阻，因此外部只需连接一个电容到地即可构成一阶环路滤波器 。
4.  **解调输出**：解调后的基带信号从环路滤波器的输出端（即VCO的控制电压端）引出。为了进一步滤除高频噪声，通常还会在此之后增加一个额外的低通滤波器（后检测滤波器）。
5.  **其他引脚**：NE564还包含一个施密特触发器（用于方波输出）和一个参考电压源，可以根据需要进行连接。

通过合理选择外部元件参数，可以设计出一个高性能的FM解调器。例如，在山东大学的一个高频电子线路实验中，就详细讲解了使用NE564进行锁相环调频及解调的实验过程，包括测量中心频率、观察调频波形以及鉴频原理的分析，为实际应用提供了宝贵的参考 。

### 2.4 正交相干解调法：理论最优解

正交相干解调法，又称同步解调法，是理论上性能最优的FM解调技术。与前述的非相干解调方法不同，它需要一个与输入FM信号的载波在频率和相位上都严格同步的本地参考信号。这种方法利用了信号的正交分解原理，通过将输入信号与两个正交的本地载波（一个同相，一个正交）相乘，可以精确地提取出信号的瞬时相位信息，从而实现无失真解调。

#### 2.4.1 核心原理：相干检测与相位比较

正交相干解调的核心在于“相干”二字，即本地产生的参考信号必须与输入信号的载波保持固定的相位关系。其基本原理可以概括为：
1.  **正交载波生成**：在接收端，需要生成两个本地载波信号，一个与原始载波同相（`cos(ωc t)`），另一个与其正交（`sin(ωc t)`）。这两个信号构成了一个正交基。
2.  **乘法与积分**：将输入的FM信号 `s_FM(t)` 分别与这两个正交载波相乘。根据三角函数的积化和差公式，乘法的结果会产生一个低频分量（与基带信号相关）和一个高频分量（频率为 `2ωc`）。
3.  **低通滤波**：通过低通滤波器滤除高频分量，保留低频分量。这样，我们就得到了两个正交分量，通常称为同相分量 `I(t)` 和正交分量 `Q(t)`。这两个分量共同携带了原始FM信号的全部相位和幅度信息。
4.  **相位信息提取**：通过 `I(t)` 和 `Q(t)` 分量，可以计算出输入信号的瞬时相位 `φ(t) = arctan(Q(t) / I(t))`。
5.  **频率解调**：由于瞬时频率是瞬时相位的导数，即 `ω(t) = dφ(t)/dt`，因此只需对计算出的瞬时相位 `φ(t)` 进行微分，即可得到与基带信号 `m(t)` 成正比的瞬时频率偏移，从而实现解调。

#### 2.4.2 数学推导：窄带FM信号的近似与还原

对于窄带FM（NBFM）信号，其调制系数 `βf` 远小于1。在这种情况下，FM信号的表达式可以进行简化。原始的FM信号为：
$$ s_{\text{FM}}(t) = A \cos\left[ \omega_c t + \beta_f \sin(\omega_m t) \right] $$
利用三角恒等式展开，并考虑到 `βf` 很小，`cos(βf sin(ωm t)) ≈ 1`，`sin(βf sin(ωm t)) ≈ βf sin(ωm t)`，可以得到NBFM信号的近似表达式：
$$ s_{\text{NBFM}}(t) \approx A \cos(\omega_c t) - A \beta_f \sin(\omega_m t) \sin(\omega_c t) $$
这个表达式可以看作是载波 `A cos(ωc t)` 和一个抑制载波的双边带（DSB-SC）信号 `-A βf sin(ωm t) sin(ωc t)` 的叠加。现在，我们将这个信号与两个正交载波相乘并低通滤波：
-   与同相载波 `cos(ωc t)` 相乘：
    $$ s_{\text{NBFM}}(t) \cos(\omega_c t) \approx \frac{A}{2} [1 + \cos(2\omega_c t)] - \frac{A \beta_f}{2} \sin(\omega_m t) \sin(2\omega_c t) $$
    低通滤波后，得到同相分量 `I(t) ≈ A/2`。
-   与正交载波 `sin(ωc t)` 相乘：
    $$ s_{\text{NBFM}}(t) \sin(\omega_c t) \approx \frac{A}{2} \sin(2\omega_c t) - \frac{A \beta_f}{2} \sin(\omega_m t) [1 - \cos(2\omega_c t)] $$
    低通滤波后，得到正交分量 `Q(t) ≈ (A βf / 2) sin(ωm t)`。
    从 `Q(t)` 分量中，我们可以直接得到与基带信号 `m(t) = Vm cos(ωm t)` 成正比的信号 `sin(ωm t)`。因此，对于NBFM信号，正交相干解调可以非常有效地恢复出基带信号。

#### 2.4.3 性能分析：最优线性度与无门限效应

正交相干解调法在性能上具有显著优势：
-   **最优线性度**：由于解调过程是基于精确的数学运算（乘法、滤波、反正切、微分），而不是依赖于硬件网络的近似线性特性，因此其理论线性度是所有解调方法中最好的。只要本地载波能够完美同步，解调输出就能无失真地复现原始基带信号。
-   **无门限效应**：非相干解调方法（如鉴频法）存在一个“门限效应”，即当输入信噪比（SNR）低于某个阈值时，解调输出的信噪比会急剧恶化。而相干解调法没有这个问题，其输出信噪比与输入信噪比始终保持线性关系，即使在信噪比非常低的情况下也能正常工作。
-   **抗干扰能力强**：由于采用了窄带滤波和相干检测，该方法对带外噪声和干扰具有很强的抑制能力。

#### 2.4.4 适用场景与局限性

尽管性能优越，正交相干解调法也有其局限性，这限制了它的广泛应用：
-   **对载波同步要求极高**：这是该方法最大的挑战。接收机必须能够生成一个与输入信号载波在频率和相位上都严格同步的本地参考信号。在实际信道中，由于多普勒频移、振荡器不稳定等因素，实现这种高精度的同步非常困难。通常需要采用复杂的载波恢复电路，如平方环、科斯塔斯环（Costas Loop）等，这大大增加了系统的复杂性和成本。
-   **仅适用于窄带FM**：上述简化的数学推导是基于NBFM的假设。对于宽带FM信号，其频谱结构复杂，直接应用正交相干解调会变得非常困难。
-   **电路复杂度高**：相比于简单的鉴频器或PLL芯片，实现一个完整的正交相干解调器需要更多的硬件资源，包括乘法器、低通滤波器、载波恢复电路等。

因此，正交相干解调法主要应用于对解调性能要求极高、且能够承受其复杂性的专业领域，如深空通信、高精度测试测量仪器、以及某些特定的窄带通信系统中。在消费级电子产品中，由于其成本和复杂度的限制，PLL解调法仍然是更主流的选择。

## 3. NE564锁相环在FM解调中的深度应用

NE564是一款由Signetics（现为NXP Semiconductors）推出的高性能单片锁相环（Phase-Locked Loop, PLL）集成电路，其工作频率可高达50MHz以上，特别适用于高频FM信号的解调 。与传统的分立元件鉴频器相比，NE564集成了鉴相器、压控振荡器（VCO）和后检测处理器等核心模块，极大地简化了电路设计，并提供了更高的解调线性度、更强的抗干扰能力和更优的温度稳定性。其内部采用肖特基钳位晶体管和优化的器件几何结构，使其在高频应用中表现出色 。NE564不仅可用于经典的FM解调，还能作为FSK（频移键控）解调器、频率合成器或调制器使用，具有广泛的应用场景 。本章节将深入剖析NE564的内部结构、工作原理，并建立其在FM解调应用中的精确数学模型，为后续的电路设计和性能优化提供坚实的理论基础。

### 3.1 NE564内部结构与工作原理

NE564的内部结构可以划分为三个主要功能模块：相位比较器（鉴相器）、压控振荡器（VCO）和后检测处理器。这三个模块协同工作，构成了一个完整的锁相环系统，能够实现对输入信号频率和相位的精确跟踪。理解每个模块的内部电路构成和工作特性，是掌握NE564应用的关键。

#### 3.1.1 相位比较器（鉴相器）的组成与特性

相位比较器是PLL的核心，负责检测输入信号与VCO反馈信号之间的相位差，并将其转换为相应的误差电压。NE564的相位比较器部分由一个**双平衡调制器（Double-Balanced Mixer）** 和一个**限幅放大器（Limiter Amplifier）** 组成 。双平衡调制器是实现相位检测的关键，它通过将两个输入信号相乘，产生包含相位差信息的输出。限幅放大器的作用是在输入信号进入鉴相器之前对其进行限幅处理，这能有效抑制输入信号的幅度变化（AM噪声），从而提高鉴相器对相位变化的灵敏度，增强整个环路的抗干扰能力。这种设计使得NE564在处理叠加有噪声的FM信号时，能够表现出优异的性能。

NE564的鉴相器增益（$K_d$），即单位相位差产生的输出电压，是一个关键参数。其数值并非固定不变，而是可以通过外部电路进行调节。根据官方应用笔记AN179的描述，鉴相器内部的差分放大器（由$Q_{13}$和$Q_{14}$构成）的跨导（$g_M$）与$Q_{15}$的镜像电流成正比 。通过在**引脚2（Pin 2）** 引入外部电流，可以改变这个镜像电流，从而调节差分放大器的增益，进而改变鉴相器的转换增益$K_d$。这种设计为工程师提供了极大的灵活性，可以根据具体应用需求（如环路带宽、捕获范围等）对PLL的动态性能进行优化。例如，在需要快速捕获信号的应用中，可以增大$K_d$以提高环路增益；而在需要高稳定性的场合，则可以适当减小$K_d$。此外，NE564的输入级采用了肖特基钳位的垂直PNP晶体管，使其能够直接兼容TTL电平输入，这在数字通信系统中是一个非常重要的特性 。

#### 3.1.2 压控振荡器（VCO）的自由运行频率与调谐

压控振荡器（VCO）是PLL中的另一个核心模块，其振荡频率受控于鉴相器输出的误差电压。在NE564中，VCO的自由运行频率（$f_0$），即控制电压为零时的振荡频率，是系统设计中的一个重要基准。根据官方数据手册，NE564的VCO自由运行频率主要由连接在特定引脚上的外部定时电阻（$R_C$）和电容（$C_1$）决定，其关系可以用以下公式近似表示 ：

$$
f_0 \approx \frac{1}{22 \cdot R_C \cdot (C_1 + C_S)}
$$

其中：
- $f_0$ 是VCO的自由运行频率，单位为Hz。
- $R_C$ 是内部集成的定时电阻，典型值为100Ω 。
- $C_1$ 是外部连接的定时电容，单位为法拉（F）。
- $C_S$ 是电路的寄生电容，在设计时需要予以考虑。

这个公式为工程师提供了精确设定VCO中心频率的方法。在实际应用中，通常会将VCO的自由运行频率$f_0$调整到与待解调的FM信号的载波中心频率$f_c$一致，这样可以确保PLL在没有调制信号时处于锁定状态的边缘，从而获得最大的线性解调范围和最佳的解调性能。微调VCO频率通常通过并联一个小的微调电容来实现，以补偿元件公差和温度漂移带来的影响。VCO的转换增益（$K_{VCO}$），即单位控制电压变化引起的频率变化量，同样是决定PLL环路动态特性的关键参数。在NE564中，VCO的转换增益与鉴相器的共模输出电压有关，而此共模电压又受到引脚2偏置电流的影响，因此，通过调节引脚2的电流，可以同时影响鉴相器增益和VCO增益，实现对环路整体性能的精细调控 。

#### 3.1.3 后检测处理器：跨导放大器与比较器

NE564的一个显著特点是其内部集成了一个功能强大的**后检测处理器（Post Detection Processor）** ，该处理器由一个单位增益的**跨导放大器（Transconductance Amplifier）** 和一个具有可调滞后的**比较器（Comparator）** 组成 。这个模块极大地增强了NE564在解调应用中的灵活性和性能。跨导放大器的主要作用之一是作为**直流恢复器（DC Retriever）** ，这对于FSK信号的解调至关重要。在FSK解调中，PLL的输出电压会在两个代表“0”和“1”的直流电平之间切换。然而，由于VCO自由运行频率的温度漂移或输入信号电平的变化，这两个直流电平的绝对值可能会发生偏移，导致判决错误。直流恢复器通过与**引脚14（Pin 14）** 的外部电容构成一个积分器，能够提取出信号的平均直流分量，并将其作为比较器的动态参考电平。这样，即使输入信号的直流电平发生漂移，比较器也能准确地识别出FSK信号的逻辑状态，从而大大提高了系统的稳定性和可靠性 。

对于线性FM解调，这个跨导放大器则可以作为一个后检测滤波器，用于滤除解调输出中的高频噪声和载波泄漏，进一步平滑输出信号 。后检测处理器中的比较器则是一个**施密特触发器（Schmitt Trigger）** ，其滞后特性（Hysteresis）可以通过连接在**引脚15（Pin 15）** 的外部电阻或电位器进行调节 。滞后特性的引入可以有效消除输出信号中由于噪声或相位抖动引起的毛刺，确保输出为干净的数字逻辑信号。这在FSK解调应用中尤为重要，因为它能将模拟的解调电压整形为标准的TTL/CMOS电平，便于后续的数字电路处理。通过调节滞后宽度，可以在系统灵敏度和抗噪声能力之间做出权衡，以适应不同的信道条件。

### 3.2 NE564 FM解调的数学模型与公式

为了深入理解和精确设计基于NE564的FM解调电路，建立一个清晰的数学模型是必不可少的。该模型能够定量地描述输入FM信号的频率变化与解调输出电压之间的关系，并为环路滤波器的设计、解调线性度的分析以及抗噪声性能的评估提供理论依据。

#### 3.2.1 VCO控制电压与频率偏移的关系式

NE564作为FM解调器的核心原理在于，当PLL处于锁定状态时，其内部VCO的瞬时频率会精确地跟踪输入FM信号的瞬时频率。VCO的控制电压（$V_O$）直接反映了输入信号频率相对于VCO自由运行频率（$f_0$）的偏移量。根据Signetics官方应用笔记中给出的关键公式，PLL的输出电压（即VCO的控制电压）与输入信号频率之间的关系可以表示为 ：

$$
V_O = \frac{f_{IN} - f_0}{K_{VCO}}
$$

其中：
- $V_O$ 是解调输出电压，即VCO的控制电压。
- $f_{IN}$ 是输入FM信号的瞬时频率。
- $f_0$ 是VCO的自由运行频率。
- $K_{VCO}$ 是VCO的转换增益，单位为Hz/V。

对于一个FM信号，其瞬时频率$f_{IN}$可以表示为载波中心频率$f_c$与由调制信号$m(t)$引起的频率偏移之和：

$$
f_{IN} = f_c + \Delta f(t) = f_c + k_f \cdot m(t)
$$

其中，$k_f$是调制器的频率灵敏度（Hz/V）。在理想情况下，我们将VCO的自由运行频率$f_0$设置为等于载波中心频率$f_c$。将此关系代入上述公式，我们得到：

$$
V_O = \frac{(f_c + k_f \cdot m(t)) - f_c}{K_{VCO}} = \frac{k_f \cdot m(t)}{K_{VCO}}
$$

这个公式揭示了NE564 FM解调器的核心数学模型：**解调输出电压$V_O$与原始的基带调制信号$m(t)$成正比**。比例系数由调制器的频率灵敏度$k_f$和VCO的转换增益$K_{VCO}$共同决定。这个线性关系是PLL解调法相比于其他鉴频方法（如斜率鉴频）具有更高线性度和更低失真的根本原因。例如，假设一个FM广播信号的最大频偏$\Delta f_{max}$为75kHz，如果NE564的VCO增益$K_{VCO}$为100kHz/V，那么在最大频偏时，解调输出的峰值电压将为$V_{O,max} = 75 \text{ kHz} / 100 \text{ kHz/V} = 0.75 \text{ V}$。

#### 3.2.2 鉴相器增益（Kd）与偏置电流的关系

鉴相器增益$K_d$（单位：V/rad）是PLL环路中的一个核心参数，它定义了单位相位差所产生的输出电压。在NE564中，$K_d$并非一个固定值，而是可以通过外部引脚进行调节的，这为系统设计提供了极大的灵活性。根据官方应用笔记AN179的详细分析，鉴相器的增益与**引脚2（Pin 2）** 的偏置电流（$I_{BIAS}$）密切相关 。其关系可以用以下经验公式来描述：

$$
K_d \approx 0.46 \left( \frac{\text{volts}}{\text{rad}} \right) + 7.3 \times 10^{-4} \left( \frac{\text{volts}}{\text{rad} \cdot \mu A} \right) \times I_{BIAS}(\mu A)
$$

这个公式表明，鉴相器增益由两部分组成：一个固定的基础增益（0.46 V/rad）和一个与偏置电流成正比的动态增益。通过向引脚2注入或吸收电流，可以线性地调节$K_d$的值。这种调节机制的原理在于，偏置电流改变了鉴相器内部差分放大器的跨导，从而影响了其转换增益。需要注意的是，这个线性关系仅在偏置电流小于800μA时成立，超过此值后，鉴相器内部晶体管会进入饱和区，导致增益调节失效 。

调节$K_d$对PLL的整体性能有深远影响。PLL的环路增益（$K_{LOOP}$）正比于$K_d$和$K_{VCO}$的乘积。因此，通过改变$K_d$，可以直接改变环路的带宽、捕获范围和锁定时间。例如，在系统启动或信号捕获阶段，可以暂时增大$K_d$以拓宽捕获范围，加快锁定速度；一旦锁定，再将$K_d$恢复到正常值，以优化环路的跟踪性能和噪声抑制能力。这种可编程的特性使得NE564能够适应各种不同的应用场景和信号条件。

#### 3.2.3 环路滤波器的设计与传递函数

环路滤波器（Loop Filter）是PLL中连接鉴相器和VCO的关键环节，其作用是滤除鉴相器输出中的高频分量和噪声，为VCO提供一个平滑的控制电压，并决定整个环路的动态响应特性。NE564的环路滤波器设计相对简单，主要通过在**引脚4和引脚5（Pins 4 and 5）** 上连接外部电容来实现。其内部已经集成了两个1.3kΩ的电阻（$R_{12}$和$R_{13}$），与外部电容$C_3$构成一个一阶低通滤波器 。

该一阶环路滤波器的传递函数$F(s)$可以表示为：

$$
F(s) = \frac{1}{1 + s \cdot R \cdot C_3}
$$

其中：
- $s$ 是拉普拉斯变换的复频率变量。
- $R$ 是内部电阻，值为1.3kΩ。
- $C_3$ 是外部连接的环路滤波电容。

这个滤波器在环路传递函数中引入了一个极点，其角频率为$\omega_p = \frac{1}{R \cdot C_3}$。通过选择不同的$C_3$值，可以调整环路滤波器的截止频率，进而控制PLL的环路带宽。环路带宽是一个至关重要的设计参数，它决定了PLL能够跟踪的输入信号的最大频率变化速率，也影响着环路的噪声性能和稳定性。一个较窄的环路带宽可以有效地滤除噪声，提高解调输出的信噪比，但对快速变化的频率跟踪能力较弱；反之，一个较宽的环路带宽可以实现对快速频率变化的良好跟踪，但会引入更多的噪声。因此，在设计时需要在解调带宽和抗噪声性能之间进行权衡，选择一个合适的$C_3$值。此外，在引脚14上的后检测滤波电容也起到了进一步平滑输出信号的作用，它与跨导放大器共同构成了一个积分器，其时间常数同样影响着最终的解调输出质量 。

### 3.3 NE564 FM解调电路设计与实现

基于对NE564内部结构和工作原理的理解，我们可以进行实际的FM解调电路设计。本节将详细介绍NE564在不同供电电压下的典型应用电路，并探讨关键外部元件（如环路滤波电容、VCO定时电容）的选择与计算方法。

#### 3.3.1 5V与12V供电下的典型应用电路

NE564的一个突出优点是其灵活的供电电压范围，能够工作在**+5V和+12V**两种常见的系统电源下，这使其能方便地集成到TTL或模拟电路系统中。官方数据手册和应用笔记为这两种供电方案都提供了典型的应用电路图 。

在**+5V供电**的应用中，NE564可以直接与TTL逻辑电路接口，其输入和输出电平都与TTL兼容。这对于数字通信系统，如FSK解调，非常方便。典型的5V FM解调电路连接方式如图A和图B所示（引自数据手册）。输入的FM信号通过交流耦合电容送入引脚6（Pin 6）。解调后的输出信号从引脚14（Pin 14）提取。环路滤波由连接在引脚4和引脚5上的电容提供，而引脚14上的电容则作为后检测滤波器，进一步平滑输出波形。

在**+12V供电**的应用中，NE564可以获得更大的动态范围和更高的输出电压摆幅，这对于需要高信噪比的模拟FM解调应用（如音频广播）更为有利。其连接方式与5V应用类似，但需要注意各引脚的电压范围和外部元件的耐压值。无论是5V还是12V供电，电路的基本拓扑结构是相同的，核心在于根据供电电压和具体应用需求，合理选择和配置外部元件的参数。例如，在FSK解调应用中，可以利用后检测处理器中的比较器，将引脚14的模拟输出整形为数字信号，并从引脚16（Pin 16）输出TTL兼容的方波信号 。

#### 3.3.2 环路滤波电容与后检测滤波电容的选择

环路滤波电容（$C_{LF}$，连接在引脚4和5）和后检测滤波电容（$C_{DF}$，连接在引脚14）的选择是决定NE564解调性能的关键步骤。这两个电容的值直接影响着解调输出的带宽、信噪比和稳定性。

**环路滤波电容（$C_{LF}$）** 的选择主要决定了PLL的环路带宽。如前所述，环路带宽与$C_{LF}$的乘积成反比。选择$C_{LF}$时，需要综合考虑以下因素：
1.  **调制信号的最高频率（$f_m$）** ：环路带宽必须足够宽，以无失真地通过最高频率的调制信号。通常，环路带宽应至少为$f_m$的2到3倍。
2.  **抗噪声性能**：较窄的环路带宽可以更好地抑制输入信号中的噪声和载波泄漏，从而提高解调输出的信噪比。
3.  **捕获范围与锁定时间**：较宽的环路带宽可以提供更大的频率捕获范围和更快的锁定时间，但可能会牺牲稳定性。

一个常用的设计方法是，首先根据所需的环路带宽$B_L$（Hz）来估算$C_{LF}$的值。对于一阶环路，其3dB带宽约为$f_{3dB} = \frac{1}{2\pi R C_{LF}}$，其中$R=1.3k\Omega$。因此，$C_{LF} \approx \frac{1}{2\pi R B_L}$。

**后检测滤波电容（$C_{DF}$）** 与内部的跨导放大器构成一个积分器，其主要作用是滤除解调输出中的高频噪声和残余载波分量，对输出信号进行最终的平滑处理。$C_{DF}$的选择决定了该积分器的时间常数$\tau = \frac{C_{DF}}{g_M}$，其中$g_M$是跨导放大器的跨导（典型值为9mS）。这个时间常数应远大于调制信号的周期，以确保有效的滤波效果，但又不能过大，以免引起解调信号的相位失真。通常，$C_{DF}$的值会在几十纳法（nF）到几微法（μF）之间选择，具体取决于基带信号的频率范围。

#### 3.3.3 VCO自由运行频率的设定与微调

精确设定VCO的自由运行频率$f_0$是确保NE564 FM解调器工作在最佳状态的前提。如前所述，$f_0$主要由外部定时电容$C_1$决定。在实际设计中，首先需要根据待解调信号的载波中心频率$f_c$来计算所需的$C_1$值。利用公式$f_0 \approx \frac{1}{22 R_C (C_1 + C_S)}$，可以初步估算出$C_1$的理论值 。

然而，由于实际电路中存在寄生电容$C_S$以及电阻、电容元件的制造公差，理论计算值往往与实际需求存在偏差。因此，必须提供一种微调机制来精确地将$f_0$校准到$f_c$。最常用的方法是在主定时电容$C_1$上并联一个小的**微调电容**（如一个5-20pF的可变电容或一个固定的小电容与一个微调电位器的组合）。通过调整这个微调电容，可以在一定范围内连续地改变VCO的自由运行频率。

校准过程通常在无调制信号输入的情况下进行。将FM信号源的中心频率$f_c$设置为所需的载波频率，并将其输入NE564。然后，用示波器或频率计监测VCO的输出（或通过观察引脚14的直流电平），同时调节微调电容，直到PLL进入锁定状态。在锁定状态下，引脚14的直流电平会稳定在一个中间值，表明VCO的频率已经精确地跟踪上了输入信号的载波频率。这个过程确保了在后续有调制信号输入时，PLL能够在其线性工作范围内对频率的上下偏移进行对称的解调，从而获得失真最小的解调输出。在一些对频率稳定性要求极高的应用中，还需要考虑温度补偿措施，以减小VCO频率随温度变化而产生的漂移 。

### 3.4 NE564 FM解调性能优化与关键指标

为了在实际工程应用中充分发挥NE564的性能，必须对其关键性能指标进行深入分析，并采取相应的优化措施。这些指标包括鉴频曲线的线性度、抗噪声能力、解调带宽以及温度稳定性等。通过对这些指标的优化，可以设计出满足不同应用场景需求的高性能FM解调器。

#### 3.4.1 鉴频曲线的线性范围与失真分析

鉴频曲线的线性范围是衡量FM解调器性能的一个核心指标，它定义了输出电压与输入频率偏移之间的线性关系范围。一个理想的鉴频器应该在一个较宽的频率范围内都具有线性的输出特性，这样才能保证对大频偏的FM信号进行无失真解调。NE564的鉴频曲线线性度主要取决于其内部VCO的线性度和鉴相器的性能。数据手册中提到，为了获得足够的解调输出信号，输入信号的频率偏差应至少为1% 。这暗示了在较小的频偏下，鉴频曲线的线性度可能不佳，或者输出幅度不足。在实际应用中，可以通过调整环路增益（通过引脚2的偏置电流）来优化线性范围。适当增加环路增益可以扩展线性范围，但过高的增益可能导致环路不稳定。因此，需要在线性度和稳定性之间进行权衡。失真分析通常通过测量解调输出信号的总谐波失真（THD）来进行。例如，可以注入一个已知频偏和频率的FM信号，然后测量解调输出中的谐波分量，计算出THD。一个设计良好的NE564解调电路，其THD可以控制在1%以下 。

#### 3.4.2 抗噪声性能与信噪比（SNR）分析

FM调制的一个主要优点就是其出色的抗噪声性能，而NE564作为一款高性能的PLL解调芯片，继承了这一优点并进一步增强。其抗噪声能力主要来源于以下几个方面：首先，NE564内部集成的限幅放大器能够有效抑制输入信号中的幅度噪声（AM噪声），因为FM信号的信息承载在频率上，幅度上的波动被视为噪声 。其次，锁相环本身具有窄带滤波特性，环路滤波器可以有效地滤除带外噪声，只让与环路带宽内的信号通过。NE564的噪声抑制能力可以通过噪声抑制率（Noise Rejection Ratio, NR）来量化，其计算公式为 ：

$$
NR = 10 \times \log_{10} \left( \frac{P_{noise, before}}{P_{noise, after}} \right)
$$

其中 $P_{noise, before}$ 和 $P_{noise, after}$ 分别是抑制前后的噪声功率。NE564因其低相位噪声和高稳定性的VCO设计，在整个工作温度范围内都能保持良好的噪声抑制能力 。信噪比（SNR）是衡量解调输出信号质量的关键指标。在FM系统中，存在一个“门限效应”，即当输入信噪比低于某个门限值时，输出信噪比会急剧下降。NE564通过其优化的电路设计，可以降低这个门限值，从而在较差的信噪比条件下仍能保持良好的解调性能。

#### 3.4.3 解调带宽与环路带宽的权衡

在NE564的FM解调应用中，解调带宽和环路带宽是两个密切相关但又需要仔细权衡的参数。解调带宽指的是解调器能够无失真地还原的基带信号的最高频率，它由后检测滤波器的截止频率决定。环路带宽则是指锁相环能够有效跟踪输入信号频率变化的频率范围，它由环路滤波器的参数决定。这两个带宽的选择直接影响到解调性能和系统的动态响应。一个较宽的环路带宽可以使PLL更快地锁定信号，并能跟踪更大频偏的信号，但这也意味着更多的噪声会进入环路，从而降低解调输出的信噪比。反之，一个较窄的环路带宽可以更好地抑制噪声，提高信噪比，但会导致锁定时间变长，对快速变化的频率跟踪能力变差。因此，在设计时，需要根据具体的应用需求来选择合适的带宽。例如，对于高保真音频广播，解调带宽需要达到15kHz，而环路带宽则需要根据FM信号的频偏和调制频率来仔细设计，以在保证跟踪性能的同时最大化信噪比。

#### 3.4.4 温度稳定性与VCO频率漂移的补偿

温度变化是影响模拟电路性能的一个主要因素，对于NE564这样的高频锁相环芯片也不例外。其内部的VCO频率会随着环境温度的变化而发生漂移，这会导致PLL的中心频率偏离输入FM信号的载波频率，从而影响锁定性能和解调质量 。NE564的数据手册中给出了VCO频率随温度漂移的典型值，例如在0到70°C的工作温度范围内，频率漂移可能达到500至1500 PPM/°C 。为了解决这个问题，需要采取一些温度补偿措施。一种常见的方法是使用具有负温度系数的电容（如NPO电容）作为VCO的定时电容，以抵消VCO内部元件的正温度系数效应。另一种更精确的方法是使用温度补偿电路，例如通过热敏电阻网络来动态调节VCO的控制电压，从而补偿频率漂移。在FSK解调应用中，由于VCO自由运行频率的漂移会导致解调输出的直流电平发生变化，可能引发误判，因此温度补偿显得尤为重要。NE564的后检测处理器中的施密特触发器滞回电压的可调性，也为在不同温度下优化判决门限提供了便利 。

## 4. FM系统关键性能指标与工程实践

### 4.1 抗干扰能力分析

#### 4.1.1 对幅度噪声的抑制原理

FM系统最显著的优势之一是其对幅度噪声（AM噪声）的卓越抑制能力。这一特性源于FM信号的**恒包络**本质。在FM调制中，信息被编码在载波的频率变化中，而其幅度 $A$ 始终保持恒定。在信号传输过程中，信道引入的绝大多数干扰（如热噪声、大气噪声、电磁干扰）主要表现为对信号幅度的随机调制。在FM接收机中，解调过程的第一步通常是**限幅**。限幅器是一个非线性电路，其功能是将输入信号的幅度“削平”，无论输入信号的幅度如何波动，其输出信号的幅度都被限制在一个固定的电平。这个过程可以有效地去除所有叠加在FM信号上的幅度噪声，而信号中携带的频率信息则完好无损。因此，经过限幅器后，信号的信噪比得到了极大的改善。相比之下，AM系统对幅度噪声非常敏感，因为AM信号的信息本身就承载在幅度上，任何幅度上的干扰都会直接转化为解调输出中的噪声，导致信噪比下降。

#### 4.1.2 信噪比（SNR）与调制指数的关系

在理想的FM解调器中，输出信噪比（SNR）与输入信噪比之间存在一个非线性的关系，这个关系由**调制指数 $\beta_f$** 决定。当输入信噪比高于门限值时，FM解调器的输出信噪比可以表示为：

$$
\text{SNR}_{\text{out}} \approx 3 \beta_f^2 (\beta_f + 1) \cdot \text{SNR}_{\text{in}}
$$

这个公式表明，**输出信噪比与调制指数 $\beta_f$ 的立方成正比**。这意味着，通过增加调制指数（即增大频偏），可以显著提高解调输出的信噪比。这种现象被称为 **“FM改善因子”** 或 **“FM增益”** 。其物理意义在于，大的频偏使得信号的频率变化范围更宽，解调器能够更容易地将频率的微小变化与噪声区分开来。频率的微小变化在解调后会产生较大的电压变化，而噪声则没有这种放大效应。因此，在带宽允许的情况下，选择较大的调制指数是提高FM系统抗噪声性能的有效手段。这也是为什么高保真FM广播（如 $\beta_f \approx 5$）比窄带FM通信（如 $\beta_f < 0.5$）具有更好音质和更强抗干扰能力的原因。

#### 4.1.3 门限效应与改善方法

尽管FM系统具有优异的抗噪声性能，但它也存在一个固有的缺点，即**门限效应（Threshold Effect）** 。门限效应是指当输入信噪比（SNR）降低到一个特定的临界值（称为**门限**）时，解调输出的信噪比会急剧恶化，不再是线性关系。当输入信噪比高于门限时，输出信噪比随着输入信噪比的改善而线性增加（并受到FM增益的放大）。然而，一旦输入信噪比低于门限，输出信噪比会迅速下降，通信质量变得很差。

门限效应的产生是由于在极低信噪比条件下，噪声的幅度变得与信号幅度相当，甚至超过信号幅度。此时，噪声会引起信号相位的剧烈随机跳变，这种现象称为“相位滑移”或“周跳”。这些随机的相位跳变在解调后会产生大量的脉冲噪声，严重污染了输出信号，导致信噪比急剧下降。

改善门限效应的方法主要有：
1.  **提高输入信噪比**：这是最根本的方法，可以通过提高发射功率、使用高增益天线、降低接收机噪声系数等方式实现。
2.  **采用预加重和去加重技术**：在发射端对高频分量进行预加重（放大），在接收端进行相应的去加重（衰减）。这可以在不增加总功率的情况下，提高高频部分的信噪比，从而改善整体的输出信噪比。
3.  **使用锁相环（PLL）解调器**：相比于传统的鉴频器，PLL解调器具有更低的门限值。这是因为PLL的窄带跟踪特性使其能够更好地抑制噪声，并且在一定程度上抵抗相位滑移的发生。
4.  **采用频率调制负反馈（FMFB）解调器**：这是一种更复杂的解调技术，通过引入一个负反馈环路来压缩FM信号的频偏，从而降低解调器输入端的等效噪声带宽，有效降低门限。
